# 第一章 网络概述
![[Pasted image 20240625124455.png]]
![[Pasted image 20240625124528.png]]
![[Pasted image 20240625125032.png]]
#### 一、计算机网络最重要的功能

计算机网络的最重要功能是**资源共享**和**信息传输**。

- **资源共享**: 允许不同计算机和设备共享硬件资源（如打印机、存储设备）和软件资源（如应用程序、数据文件）。
- **信息传输**: 实现数据和信息在不同计算机和设备之间的高效传输和交换。

#### 二、因特网的两大组成部分

因特网主要由两大部分组成：

- **边缘部分**: 包括所有终端用户设备，如计算机、智能手机、服务器等。这些设备通过网络进行通信和资源共享。
- **核心部分**: 包括各种网络设备和基础设施，如路由器、交换机、光纤电缆等，负责实现数据的高速传输和路由选择。

#### 三、三种交换方式

计算机网络中常见的三种交换方式是：

1. **电路交换**: 在通信双方之间建立一条固定的物理连接，整个通信过程都使用这条连接。优点是实时性强，缺点是资源利用率低。
2. **报文交换**: 将数据分割成报文，每个报文独立传输，沿途存储转发。优点是灵活性高，缺点是时延较大。
3. **分组交换**: 将数据分割成较小的分组（包），每个分组独立传输，沿途存储转发。优点是资源利用率高，时延较小，是现代计算机网络的主要交换方式。

#### 四、计算机网络的分类：按地域（中英文名称）

根据地域范围，计算机网络可以分为：

1. **局域网（LAN, Local Area Network）**: 覆盖范围较小，通常在一个建筑物或校园内。
2. **城域网（MAN, Metropolitan Area Network）**: 覆盖范围中等，通常在一个城市或大都市区域内。
3. **广域网（WAN, Wide Area Network）**: 覆盖范围较大，通常跨越多个城市、国家甚至洲际。

#### 五、时延

时延是指数据从源节点传输到目的节点所需要的时间，主要由以下四个部分组成：

1. **传输时延**: 数据在传输介质上传输所需要的时间。
2. **传播时延**: 信号在介质中传播所需要的时间，通常与介质的长度和信号的传播速度有关。
3. **处理时延**: 路由器或交换机处理数据包所需要的时间。
4. **排队时延**: 数据包在路由器或交换机队列中等待处理所需要的时间。

时延计算公式：  
总时延=传输时延+传播时延+处理时延+排队时延总时延=传输时延+传播时延+处理时延+排队时延
 
#### 六、协议（定义、三要素及其含义）

计算机网络协议是指通信双方为实现数据交换而共同遵守的规则和约定。协议的三要素包括：

1. **语法**: 定义数据格式和信号级别。
2. **语义**: 定义控制信息和错误处理等操作的意义。
3. **时序**: 定义事件发生的顺序和时间关系。
![[Pasted image 20240625130208.png]]
### 五层体系结构

1. **物理层（Physical Layer）**
    
    - **功能**：负责在物理媒介上传输原始比特流。它定义了硬件设备的电气、机械、规程和功能等规范。
    - **设备与技术**：包括网线、光纤、电缆、无线电波、集线器、网卡等。
    - **协议**：没有特定的协议，主要涉及电气和物理标准，如IEEE 802.3（以太网物理层标准）。
2. **数据链路层（Data Link Layer）**
    
    - **功能**：负责节点之间的可靠数据传输，包括帧的创建、传输和接收，以及错误检测和纠正。它还负责物理地址（MAC地址）的寻址。
    - **子层**：包括逻辑链路控制（LLC）子层和介质访问控制（MAC）子层。
    - **设备与技术**：交换机、桥接器等。
    - **协议**：以太网协议（IEEE 802.3）、Wi-Fi（IEEE 802.11）、PPP（点对点协议）等。
3. **网络层（Network Layer）**
    
    - **功能**：负责跨网络的路径选择和数据包转发，主要任务是路由选择和逻辑地址（IP地址）的管理。
    - **设备与技术**：路由器。
    - **协议**：IP（Internet Protocol，包括IPv4和IPv6）、ICMP（Internet Control Message Protocol）、ARP（Address Resolution Protocol）等。
4. **传输层（Transport Layer）**
    
    - **功能**：提供端到端的报文传输服务，包括数据分段、传输、重组、流量控制和错误检测与恢复。它确保数据从源到目的的可靠传输。
    - **协议**：TCP（Transmission Control Protocol）提供可靠的连接，UDP（User Datagram Protocol）提供不可靠但快速的传输。
5. **应用层（Application Layer）**
    
    - **功能**：为应用程序提供网络服务接口，直接面向用户，支持各种网络应用。
    - **协议**：HTTP（用于网页浏览）、FTP（文件传输协议）、SMTP（电子邮件传输协议）、DNS（域名系统）、SSH（安全外壳协议）等。

### TCP/IP模型与五层模型的对比

虽然TCP/IP模型通常描述为四层（网络接口层、互联网层、传输层和应用层），但它也可以与五层模型进行对比说明：

1. **网络接口层**（对应五层模型中的物理层和数据链路层）
    
    - 涵盖物理传输和数据链路控制。
2. **互联网层**（对应五层模型中的网络层）
    
    - 负责路由选择和数据包传输。
3. **传输层**（相同的传输层）
    
    - 提供端到端的通信服务。
4. **应用层**（对应五层模型中的应用层）
    
    - 直接提供应用服务给用户。

### 例子：访问网页的流程

1. **应用层**：用户在浏览器中输入URL，浏览器生成HTTP请求。
2. **传输层**：HTTP请求被TCP协议处理，分段并加上TCP头。
3. **网络层**：TCP段被IP协议处理，封装成IP数据包，进行路由选择。
4. **数据链路层**：IP数据包被封装成帧，通过数据链路层协议（如以太网）传输。
5. **物理层**：帧通过物理媒介（如网线）传输到目的地。


# 第二章 物理层


物理层是计算机网络的最底层，负责定义硬件传输数据的标准和方法。它的主要任务是传输比特流。以下是物理层的几个重要概念和技术。
![[Pasted image 20240625132838.png]]![[Pasted image 20240625132852.png]]![[Pasted image 20240625133241.png]]![[Pasted image 20240625133442.png]]![[Pasted image 20240625133645.png]]
![[Pasted image 20240625151934.png]]
#### 一、物理层关注的四个特性和每个特性的说明

1. **机械特性**：
    
    - 定义物理连接设备的机械特性，如插头、插座、引脚和接口的形状与尺寸等。
    - 例子：RJ45 接口、USB 接口。
2. **电气特性**：
    
    - 定义传输数据时的电压、电流、功率等电气参数。
    - 例子：电压电平、信号衰减、噪声干扰。
3. **功能特性**：
    
    - 定义每个引脚或接口的功能，即每个引脚的信号定义和用途。
    - 例子：RS-232 接口中引脚的功能定义。
4. **规程特性**：
    
    - 定义数据传输的过程和规则，包括信号的同步、时钟频率以及数据传输的控制方法。
    - 例子：位同步、帧同步、数据传输速率。

#### 二、常用的导向性传输媒体

导向性传输媒体是指数据通过**有形介质传播的方式**。常见的导向性传输媒体包括：

1. **双绞线 (Twisted Pair)**：
    
    - 由两根互相缠绕的绝缘铜线组成，以减少电磁干扰和串扰。
    - 使用场景：电话网络、以太网。
2. **同轴电缆 (Coaxial Cable)**：
    
    - 由内导体、绝缘层、外导体和保护套组成，具有较好的抗干扰能力和传输性能。
    - 使用场景：有线电视、早期的局域网。
3. **光缆 (Optical Fiber)**：
    
    - 通过光脉冲传输数据，具有极高的带宽和抗干扰能力。
    - 使用场景：骨干网、长距离通信。

#### 三、常用的非导向性传输媒体

非导向性传输媒体是指数据通过**自由空间传播的方式**。常见的非导向性传输媒体包括：

1. **短波（Short Wave）**：
    
    - 通过电离层反射传播，适用于长距离通信。
    - 使用场景：国际广播、远距离军事通信。
2. **微波（Microwave）**：
    
    - 通过直线传播，适用于点对点的短距离通信。
    - 使用场景：卫星通信、无线局域网。
3. **地面接力**：
    
    - 通过地面上多个中继站转发信号，适用于长距离的地面通信。
    - 使用场景：长途电话通信。
4. **卫星**：
    
    - 通过地球同步卫星转发信号，适用于全球范围的通信。
    - 使用场景：全球通信、卫星电视。

#### 四、信道复用

信道复用技术允许多个信号共享同一传输介质，以提高传输效率。常见的信道复用技术包括：

### 1. 频分复用 (FDM, Frequency Division Multiplexing)

- **描述**：频分复用通过将可用的频谱分成多个频段，每个频段传输一个独立的信号。各信号在不同频率上同时传输，因此互不干扰。
- **应用**：常用于广播电视、传统电话系统和无线通信。
- **例子**：多个广播电台在不同的频率上同时播放节目，听众可以调到不同的频率收听不同的电台。

### 2. 时分复用 (TDM, Time Division Multiplexing)

- **描述**：时分复用通过将时间划分为多个时隙，每个时隙传输一个独立的信号。各信号在不同的时间段传输，因此不会互相干扰。
- **应用**：常用于数字电话网络、计算机网络和数字通信系统。
- **例子**：在电话网络中，不同的通话数据在各自的时隙内传输，多个通话可以共享同一条线路。![[Pasted image 20240625133849.png]]

### 3. 波分复用 (WDM, Wavelength Division Multiplexing)

- **描述**：波分复用通过将光纤的波长划分为多个通道，每个波长传输一个独立的信号。不同波长的光信号可以同时在同一根光纤中传输。
- **应用**：常用于光纤通信，特别是长距离和高容量的网络。
- **例子**：在光纤通信中，不同的波长（颜色）传输不同的信息，例如红光传输数据A，绿光传输数据B，同时通过同一根光纤。

### 4. 码分复用 (CDM, Code Division Multiplexing)

- **描述**：码分复用通过为每个信号分配一个唯一的编码序列，所有信号在相同的频谱和时间内同时传输，但使用不同的编码序列进行区分。接收端使用相同的编码序列解码信号。
- **应用**：常用于无线通信和卫星通信，例如CDMA（码分多址）移动通信技术。
- **例子**：在CDMA移动通信中，每个用户的信号使用不同的编码序列进行传输，接收端根据编码序列来区分和解码不同用户的信号。
#### 五、CDMA 工作原理及计算

**CDMA（Code Division Multiple Access）**：

- 码分多址，通过给每个用户分配唯一的伪随机码，使多个用户可以在同一频谱上同时通信。
- **工作原理**：每个用户的信号被编码成具有特定伪随机序列的宽带信号，接收端使用相同的伪随机序列解码，从而区分不同用户的信号。
- **计算**：
    - **收到了什么**：接收端接收到所有用户的混合信号。
    - **发送的是什么**：每个用户发送经过伪随机码扩频的信号
# 第三章 数据链路层

数据链路层是计算机网络的第二层，主要负责可靠的数据传输和链路管理。它在物理层之上，为网络层提供服务。以下是数据链路层的关键概念和技术。

#### 使用点对点信道的数据链路层

**一、数据链路层协议的三个基本问题**

1. **封装成帧**：
    
    - 将网络层传递下来的数据封装成帧，添加帧头和帧尾以确保数据的完整性和同步。
    - 帧头和帧尾通常包含同步信息、地址信息以及其他控制信息。
2. **透明传输**：
    
    - 确保数据链路层能够传输任意数据，包括可能与控制字符冲突的数据。
    - 使用字节填充或比特填充技术来实现透明传输。
3. **差错检测**：
    
    - 确保数据在传输过程中没有被错误地篡改。
    - 使用循环冗余校验（CRC）等技术在帧中添加校验位，接收端根据校验位判断数据是否正确。

**二、差错检验：CRC的计算**

- **CRC（Cyclic Redundancy Check）**：
    - 通过在数据后面添加校验位，确保数据传输的准确性。
    - 计算方法：发送方将数据除以预定的多项式生成校验码，接收方用同样的方法检查数据是否正确。

#### 使用广播信道的数据链路层

**三、局域网按拓扑结构的分类，当前网络的拓扑**

- **拓扑结构**：
    - **总线型拓扑**：所有设备共享一个公共通信信道。
    - **星型拓扑**：所有设备通过集线器或交换机连接到中心设备。
    - **环型拓扑**：设备通过点对点连接形成一个闭环。
    - **网状拓扑**：每个设备与多个设备相连，形成网状结构。
![[Pasted image 20240625160614.png]]

**四、CSMA/CD协议（Carrier Sense Multiple Access with Collision Detection）**

- **定义**：载波监听多路访问/碰撞检测，是一种网络访问方法。
- **工作原理**：
    1. 监听信道。
    2. 如果信道空闲，开始发送数据。
    3. 如果检测到碰撞，停止发送并等待随机时间后重试。
- **作用**：用于减少数据碰撞，提高网络效率。
- **作用期**：主要用于以太网（Ethernet）。

**五、最短帧长的计算**

- 根据网络的传播速度和最大冲突域来计算最短帧长，以确保碰撞被检测到。

**六、以太网的最短帧长和MTU**
- **以太网最短帧长**：**64字节。**
- **MTU（Maximum Transmission Unit）**：最大传输单元，**通常为1500字节。**

**七、以太网标准：10BaseT的含义**

- **10BaseT**：一种以太网标准，表示**10 Mbps**的传输速率，基带传输，采用双绞线。

**八、扩展的以太网**

1. **集线器、交换机工作的层次**：
    
    - 集线器（Hub）：工作在物理层，转发每个端口收到的信号。
    - 交换机（Switch）：工作在数据链路层，根据MAC地址转发数据帧。
2. **使用交换机和集线器的以太网每个用户的平均带宽**：
    
    - 集线器：所有用户共享总带宽。
    - 交换机：每个用户独享带宽。
3. **交换机和转发分组时使用的地址（硬件地址）**：
    
    - 使用MAC地址进行数据帧的转发。
4. **集线器、交换机可以隔离碰撞域的个数**：
    
    - **集线器**：所有端口属于同一个碰撞域。
    - **交换机**：每个端口属于独立的碰撞域。
5. **集线器、交换机所处的广播域**：
    
    - 所有设备在同一个交换机内属于同一个广播域。

**九、交换机自学习算法的问题**

- **自学习算法**：交换机通过记录帧的源地址和端口号来构建MAC地址表，从而实现高效的数据转发。
- **问题**：需要处理地址表的更新和老化，以防止地址表过时。

通过以上内容的学习，可以更好地理解数据链路层在计算机网络中的作用及其实现方法。这些知识对于构建和维护高效、可靠的网络至关重要。

# 第四章 网络层

网络层是计算机网络的第三层，主要负责数据包的路由选择和转发。以下是网络层的一些关键概念和技术。

#### 一、网络层提供的两种服务及其特点

1. **无连接服务（Connectionless Service）**：
    
    - 特点：每个数据包独立传输，没有建立连接的过程。
    - 适用场景：适用于不需要建立连接的短消息传输，如 IP 协议。
    - 协议：IP（Internet Protocol）
2. **面向连接服务（Connection-Oriented Service）**：
    
    - 特点：在传输数据之前需要建立连接，确保数据按顺序到达。
    - 适用场景：适用于需要可靠传输和顺序传递的场景，如传输控制协议（TCP）。
    - 协议：TCP（Transmission Control Protocol）

#### 二、网络互联的设备及层次

- **路由器（Router）**：
    - 设备：用于连接不同网络，转发数据包。
    - 层次：工作在网络层，使用 IP 地址进行数据包的路由选择和转发。

#### 三、IP 地址

1. **分类**：
    ![[Pasted image 20240625171332.png]]
    - A类地址：0.0.0.0 到 127.255.255.255
    - B类地址：128.0.0.0 到 191.255.255.255
    - C类地址：192.0.0.0 到 223.255.255.255
    - D类地址：224.0.0.0 到 239.255.255.255（多播地址）
    - E类地址：240.0.0.0 到 255.255.255.255（保留地址）
2. **表示方法**：点分十进制表示法，如 192.168.0.1
    
3. **每类地址的网络号和主机号的位数**：
    
    - A类地址：网络号 8 位，主机号 24 位
    - B类地址：网络号 16 位，主机号 16 位
    - C类地址：网络号 24 位，主机号 8 位
4. **每类地址的使用范围**：
    
    - A类地址：适用于大型网络
    - B类地址：适用于中型网络
    - C类地址：适用于小型网络
![[Pasted image 20240625171743.png]]
#### 四、私有 IP 和地址转换协议

1. **私有 IP 的范围**：
    
    - A类：10.0.0.0 到 10.255.255.255
    - B类：172.16.0.0 到 172.31.255.255
    - C类：192.168.0.0 到 192.168.255.255
2. **私有 IP 的特点**：
    
    - 不能在公网上直接使用，必须通过 NAT（网络地址转换）转换成公有 IP。
    - 目的地址为私有 IP 的数据报不被路由器转发。

#### 五、地址解析协议

1. **ARP（Address Resolution Protocol）**：
    - **功能**：将 IP 地址解析成 MAC 地址。
    - **工作过程**：发送 ARP 请求广播包，目标主机回复 ARP 响应包，包含其 MAC 地址。

#### 六、IP 数据报的格式

1. **首部长度**：单位为 4 字节
2. **偏移量**：单位为 8 字节
3. **校验范围**：仅限首部
4. **数据报分片计算**：
    - 当数据报长度超过链路的 MTU 时，需要进行分片。
    - 每个片段都有偏移量和更多标志位，以便接收端重新组装。

#### 七、无分类编址 CIDR 的编址方案

1. **CIDR（Classless Inter-Domain Routing）**：
    
    - **概念**：无分类编址，不再使用传统的 A、B、C 类地址，而是使用网络前缀表示网络地址范围。
    - **特点**：灵活分配 IP 地址，提高地址利用率。
2. **子网掩码的作用**：
    
    - **作用**：用于区分网络地址和主机地址。
    - **计算网络地址和广播地址**：
        - **网络地址**：主机号全为 0
        - **广播地址**：主机号全为 1
3. **地址块计算**：
    
    - **给定地址块求网络前缀**：如 192.168.1.0/24
    - **计算可用 IP 数**：如 /24 的地址块有 256 个 IP 地址，其中 254 个可用。
4. **子网划分**：
    
    - **过程**：从主机数最多的局域网开始划分。
    - **计算子网掩码和地址块**：根据主机数确定子网掩码，然后划分地址块。
5. **路由聚合**：
    
    - **概念**：将多个小的网络前缀合并为一个大前缀，简化路由表。
    - **计算和分组转发**：根据最长匹配前缀原则进行路由选择。

#### 八、ICMP

1. **层次**：网络层
2. **应用**：
    - **Ping**：测试网络连通性。
    - **Traceroute**：跟踪数据包的路径。

#### 九、因特网路由选择协议

1. **内部网关协议（IGP）**：
    
    - **RIP（Routing Information Protocol）**：使用距离向量算法，最大跳数为 15。
    - **OSPF（Open Shortest Path First）**：使用链路状态算法。
2. **外部网关协议（EGP）**：
    
    - **BGP（Border Gateway Protocol）**：用于不同自治系统（AS）之间的路由选择。

#### 十、RIP 路由选择

1. **使用距离向量算法**：通过定期交换路由信息更新路由表。
2. **支持的最大跳数**：15
3. **路由器数目**：限制为 16 跳以内。
4. **路由表的计算**：基于跳数更新。
5. **优缺点**：简单易实现，但收敛速度慢，适用于小型网络。

#### 十一、内部网关协议 OSPF

1. **使用链路状态算法**：每个路由器维护一个网络拓扑图，使用 Dijkstra 算法计算最短路径。
2. **特点**：快速收敛，适用于大型网络。

#### 十二、路由器的作用及工作层次

1. **作用**：连接不同网络，转发数据包。
2. **工作层次**：网络层
3. **转发数据时使用的地址**：目的主机的 IP 地址

通过以上内容的学习，可以更好地理解网络层在计算机网络中的作用及其实现方法。这些知识对于构建和维护高效、可靠的网络至关重要。

# 第五章 运输层

运输层是计算机网络的第四层，主要负责在互联网上不同主机之间提供端到端的通信服务。以下是运输层的一些关键概念和技术。

#### 一、IP 协议和运输层协议的作用范围

- **IP 协议（Internet Protocol）**：
    
    - **作用范围**：点到点
    - **功能**：提供无连接、不可靠的数据包传递服务。
- **运输层协议**：
    
    - **作用范围**：端到端
    - **功能**：在两台主机的应用程序之间提供可靠的数据传输服务。

#### 二、端口的作用

- **端口**：用于标识主机上的特定应用程序或服务，通过 IP 地址和端口号的组合（即套接字）唯一标识网络中的一个进程。

#### 三、两大协议 TCP 和 UDP

- **TCP（Transmission Control Protocol）**：
    
    - **层次**：运输层
    - **特点**：面向连接、可靠传输、顺序传递、流量控制、拥塞控制。
    - **应用**：适用于文件传输、电子邮件、远程登录等需要可靠传输的场景。
- **UDP（User Datagram Protocol）**：
    
    - **层次**：运输层
    - **特点**：无连接、不可靠传输、不保证顺序、简单快速。
    - **应用**：适用于即时通信、视频流、DNS 查询等需要快速传输的场景。

#### 四、UDP 首部长度和各字段作用

- **UDP 首部长度**：8 字节
- **各字段作用**：
    - **源端口（Source Port）**：发送方的端口号。
    - **目的端口（Destination Port）**：接收方的端口号。
    - **长度（Length）**：UDP 数据报的总长度（包括首部和数据）。
    - **校验和（Checksum）**：用于错误检测。

#### 五、TCP 首部（序号、确认号、SYN、FIN、ACK 的作用）

- **序号（Sequence Number）**：标识数据段的序号，用于数据重组和重传控制。
- **确认号（Acknowledgment Number）**：确认已接收到的数据段，表示期望接收的下一个序号。
- **SYN（同步）**：用于建立连接的初始同步信号。
- **FIN（结束）**：用于释放连接，表示没有更多数据要发送。
- **ACK（确认）**：用于确认接收到的数据段。

#### 六、滑动窗口协议

- **发送窗口**：发送方可以连续发送多个数据段，而不必等待每个数据段的确认。
- **接收窗口**：接收方可以连续接收多个数据段，并在接收到所有预期数据段后发送确认。
- **工作原理**：通过发送窗口和接收窗口的移动，实现流量控制和数据传输的高效性。

#### 七、拥塞控制

1. **拥塞控制产生的原因**：
    
    - 当网络中对资源的需求总和大于可用资源时，会导致网络拥塞。
2. **拥塞控制与流量控制的区别**：
    
    - **拥塞控制**：防止网络本身过载。
    - **流量控制**：防止发送方发送数据过快，接收方无法处理。
    - **流量控制的实现**：通过滑动窗口协议或其他流量控制机制。
3. **慢启动和拥塞避免，快重传和快恢复**：
    
    - **慢启动（Slow Start）**：从小的拥塞窗口（cwnd）开始，指数增长。
    - **拥塞避免（Congestion Avoidance）**：线性增长，避免拥塞。
    - **快重传（Fast Retransmit）**：在收到三个重复的 ACK 时，立即重传丢失的数据段。
    - **快恢复（Fast Recovery）**：在快重传后，拥塞窗口减半，然后线性增长。

#### 八、TCP 建立连接的过程（三次握手协议）

1. **第一次握手**：客户端发送 SYN 包（SYN = 1，Seq = x），进入 SYN_SENT 状态。
2. **第二次握手**：服务器收到 SYN 包，发送 SYN + ACK 包（SYN = 1，ACK = 1，Seq = y，Ack = x + 1），进入 SYN_RCVD 状态。
3. **第三次握手**：客户端收到 SYN + ACK 包，发送 ACK 包（ACK = 1，Seq = x + 1，Ack = y + 1），进入 ESTABLISHED 状态，服务器也进入 ESTABLISHED 状态。

#### 九、TCP 释放连接的过程

1. **第一次释放**：客户端发送 FIN 包，进入 FIN_WAIT_1 状态。
2. **第二次释放**：服务器收到 FIN 包，发送 ACK 包，进入 CLOSE_WAIT 状态，客户端进入 FIN_WAIT_2 状态。
3. **第三次释放**：服务器发送 FIN 包，进入 LAST_ACK 状态。
4. **第四次释放**：客户端收到 FIN 包，发送 ACK 包，进入 TIME_WAIT 状态，服务器进入 CLOSED 状态。客户端在经过一定时间后也进入 CLOSED 状态。

#### 十、停止等待协议的工作原理

- **工作原理**：发送方发送一个数据段后，必须等待接收方的确认后才能发送下一个数据段。
- **优点**：简单易实现。
- **缺点**：效率低，适用于低速网络。
- **解决方案**：使用滑动窗口协议提高效率。

# 第六章 应用层

应用层是计算机网络的最高层，直接为用户和应用程序提供服务。以下是应用层的一些关键概念和技术。

#### 一、DNS（Domain Name System）

- **名称**：域名系统
    
- **功能**：将人类可读的域名转换为机器可读的 IP 地址，实现域名到 IP 地址的映射。
    
- **域名的两种解析过程**：
    
    1. **递归解析（Recursive Resolution）**：
        
        - 客户端向本地 DNS 服务器发出解析请求，本地 DNS 服务器负责查询整个域名解析过程，并返回最终的 IP 地址。
        - 过程：客户端 -> 本地 DNS 服务器 -> 根 DNS 服务器 -> 顶级域 DNS 服务器 -> 权威 DNS 服务器 -> 本地 DNS 服务器 -> 客户端。
    2. **迭代解析（Iterative Resolution）**：
        
        - 客户端向本地 DNS 服务器发出解析请求，本地 DNS 服务器逐级查询各级 DNS 服务器，并在每一级返回查询结果，最终返回给客户端。
        - 过程：客户端 -> 本地 DNS 服务器 -> 根 DNS 服务器 -> 顶级域 DNS 服务器 -> 权威 DNS 服务器 -> 客户端。

#### 二、FTP（File Transfer Protocol）

- **使用 TCP**：确保可靠的数据传输。
- **两个连接及其作用**：
    1. **控制连接（Control Connection）**：用于传输命令和响应，端口号为 21。
    2. **数据连接（Data Connection）**：用于传输文件数据，端口号为 20。

#### 三、电子邮件系统

1. **SMTP（Simple Mail Transfer Protocol）**：
    
    - **名称**：简单邮件传输协议
    - **作用**：用于在电子邮件服务器之间传输邮件。
    - **使用 TCP**：确保邮件的可靠传输。
2. **POP（Post Office Protocol）**：
    
    - **名称**：邮局协议
    - **作用**：从邮件服务器下载邮件到本地客户端，并删除服务器上的邮件。
    - **版本**：常用的是 POP3（第三版），使用端口号 110。
3. **IMAP（Internet Message Access Protocol）**：
    
    - **名称**：互联网邮件访问协议
    - **作用**：从邮件服务器读取邮件，允许在服务器上管理邮件（如标记、移动、删除等）。
    - **版本**：常用的是 IMAP4（第四版），使用端口号 143。

#### 四、HTTP（HyperText Transfer Protocol）

- **名称**：超文本传输协议
- **功能**：用于在 Web 客户端和服务器之间传输超文本（如 HTML 文档）。
- **使用 TCP**：确保网页数据的可靠传输，常用端口号为 80（HTTP）和 443（HTTPS）。

#### 五、DHCP（Dynamic Host Configuration Protocol）

- **名称**：动态主机配置协议
- **作用**：自动分配 IP 地址、子网掩码、网关和 DNS 服务器等网络配置参数给网络中的设备，简化网络管理。



# 大题



![[Pasted image 20240626204849.png]]
![[Pasted image 20240626204359.png]]

### 总结序列号和确认号变化

| 阶段            | 方向               | 包类型     | SEQ  | ACK  | 注释                              |     |
| ------------- | ---------------- | ------- | ---- | ---- | ------------------------------- | --- |
| 初始状态          | -                | -       | 1000 | -    | 客户端初始序列号                        |     |
| 初始状态          | -                | -       | 2000 | -    | 服务器初始序列号                        |     |
| 三次握手 - Step 1 | Client -> Server | SYN     | 1000 | -    | 客户端发送SYN，Seq=1000               |     |
| 三次握手 - Step 2 | Server -> Client | SYN-ACK | 2000 | 1001 | 服务器发送SYN-ACK，Seq=2000, Ack=1001 |     |
| 三次握手 - Step 3 | Client -> Server | ACK     | 1001 | 2001 | 客户端发送ACK，Seq=1001, Ack=2001     |     |
| 四次挥手 - Step 1 | Client -> Server | FIN     | 1001 | -    | 客户端发送FIN，Seq=1001               |     |
| 四次挥手 - Step 2 | Server -> Client | ACK     | 2001 | 1002 | 服务器发送ACK，Seq=2001, Ack=1002     |     |
| 四次挥手 - Step 3 | Server -> Client | FIN     | 2001 | -    | 服务器发送FIN，Seq=2001               |     |
| 四次挥手 - Step 4 | Client -> Server | ACK     | 1002 | 2002 | 客户端发送ACK，Seq=1002, Ack=2002     |     |

- **三次握手**：
    
    1. **客户端发送SYN**：序列号 `Seq=1000`，发送后序列号变为 `1001`（消耗一个序列号）。
    2. **服务器回应SYN-ACK**：序列号 `Seq=2000`，确认号 `Ack=1001`，发送后序列号变为 `2001`（消耗一个序列号）。
    3. **客户端回应ACK**：序列号 `Seq=1001`，确认号 `Ack=2001`，ACK包不消耗序列号。
- **四次挥手**：
    
    1. **客户端发送FIN**：序列号 `Seq=1001`，发送后序列号变为 `1002`（消耗一个序列号）。
    2. **服务器回应ACK**：序列号 `Seq=2001`，确认号 `Ack=1002`，ACK包不消耗序列号。
    3. **服务器发送FIN**：序列号 `Seq=2001`，发送后序列号变为 `2002`（消耗一个序列号）。
    4. **客户端回应ACK**：序列号 `Seq=1002`，确认号 `Ack=2002`，ACK包不消耗序列号。

### 三次握手
1. Client -> Server: SYN, Seq=1000
2. Server -> Client: SYN-ACK, Seq=2000, Ack=1001
3. Client -> Server: ACK, Seq=1001, Ack=2001

1. **第一次握手**：
    
    - **客户端发送SYN包**：消耗一个序列号。
    - 序列号从 `N` 增加到 `N+1`。
2. **第二次握手**：
    
    - **服务器发送SYN-ACK包**：SYN包消耗一个序列号。
    - 序列号从 `M` 增加到 `M+1`。
3. **第三次握手**：
    
    - **客户端发送ACK包**：ACK包不消耗序列号。

在三次握手过程中，**总共发送了2个SYN包**（客户端和服务器各一个），并且**总共消耗了2个序列号**。

### 四次挥手
1. Client -> Server: FIN, Seq=1001
2. Server -> Client: ACK, Seq=2001, Ack=1002
3. Server -> Client: FIN, Seq=2001
4. Client -> Server: ACK, Seq=1002, Ack=2002

1. **第一次挥手**：
    
    - **客户端发送FIN包**：消耗一个序列号。
    - 序列号从 `X` 增加到 `X+1`。
2. **第二次挥手**：
    
    - **服务器发送ACK包**：ACK包不消耗序列号。
3. **第三次挥手**：
    
    - **服务器发送FIN包**：消耗一个序列号。
    - 序列号从 `Y` 增加到 `Y+1`。
4. **第四次挥手**：
    
    - **客户端发送ACK包**：ACK包不消耗序列号。

在四次挥手过程中，**总共发送了2个FIN包**（客户端和服务器各一个），并且**总共消耗了2个序列号**。

![[Pasted image 20240627191638.png]]
根据题目的描述以及对TCP协议的理解，我们可以计算出在无任何重传的情况下，主机甲向主机乙发送的应用层数据的字节数。

### 题目分析：

1. **SYN段序号**: 甲发送的SYN段的序号为1000。根据TCP协议，SYN段会占用一个序号，因此SYN段的序号是1000，表示数据的起始序号是1001。
    
2. **FIN段序号**: 甲发送给乙的FIN段的序号为5001。FIN段也会占用一个序号，意味着数据的结束序号是5000。
    

### 计算应用层数据的字节数：

甲发送的应用层数据的起始序号是1001，而结束序号是5000。因此，数据的字节数计算如下：

数据字节数=结束序号−起始序号+1数据字节数=结束序号−起始序号+1

但是，由于起始序号1001本身已经包含在数据中，所以实际上要减去1：

数据字节数=5000−1001+1数据字节数=5000−1001+1  
数据字节数=5000−1000数据字节数=5000−1000  
数据字节数=4000数据字节数=4000

### 选项分析：

根据以上计算，甲向乙发送的应用层数据的字节数为4000字节。

因此，正确答案是：

**C、4000**


# 时延计算题

![[Pasted image 20240625155516.png]]
### 例题1：延时计算

#### 题目

一个数据包从源主机A传输到目标主机B，需要经过以下几个过程：

1. 传播延时：数据包在链路上传播的时间，链路长度为1000公里，传播速度为2×10^8米/秒。
2. 处理延时：每个路由器处理数据包的时间，每个路由器需要0.1毫秒（ms）。
3. 排队延时：每个路由器排队的平均时间为0.2毫秒（ms）。
4. 传输延时：数据包在每条链路上进行传输的时间，数据包大小为1500字节，链路带宽为10Mbps。

假设从源主机A到目标主机B需要经过3个路由器，计算总延时。

#### 解答

1. **传播延时**（Propagation Delay）：  
    传播延时计算公式为：
    
    传播延时=链路长度传播速度传播延时=传播速度链路长度​
    
    - 链路长度：1000公里 = 1000 × 10^3米
    - 传播速度：2 × 10^8米/秒
    
    传播延时为：
    
    传播延时=1000×1032×108=5毫秒传播延时=2×1081000×103​=5毫秒
    
2. **处理延时**（Processing Delay）：  
    每个路由器处理数据包的时间为0.1毫秒，经过3个路由器，总处理延时为：
    
    总处理延时=3×0.1毫秒=0.3毫秒总处理延时=3×0.1毫秒=0.3毫秒
    
3. **排队延时**（Queuing Delay）：  
    每个路由器排队的平均时间为0.2毫秒，经过3个路由器，总排队延时为：
    
    总排队延时=3×0.2毫秒=0.6毫秒总排队延时=3×0.2毫秒=0.6毫秒
    
4. **传输延时**（Transmission Delay）：  
    传输延时计算公式为：
    
    传输延时=数据包大小链路带宽传输延时=链路带宽数据包大小​
    
    - 数据包大小：1500字节 = 1500 × 8比特 = 12000比特
    - 链路带宽：10Mbps = 10 × 10^6比特/秒
    
    传输延时为：
    
    传输延时=1200010×106=0.0012秒=1.2毫秒传输延时=10×10612000​=0.0012秒=1.2毫秒
    
5. **总延时**：
    
    总延时=传播延时+总处理延时+总排队延时+传输延时总延时=传播延时+总处理延时+总排队延时+传输延时
    
    总延时=5毫秒+0.3毫秒+0.6毫秒+1.2毫秒=7.1毫秒总延时=5毫秒+0.3毫秒+0.6毫秒+1.2毫秒=7.1毫秒
    

![[Pasted image 20240628200124.png]]![[Pasted image 20240628200129.png]]
![[Pasted image 20240628200649.png]]


![[Pasted image 20240628200136.png]]

假设信号在媒体上的传播速度为2.4×10^8m/s，媒体长度L为8000km（广域网）。试计算出当数据率为10Mb/s和10Gb/s时在以上媒体中正在传播的比特数。![[Pasted image 20240628202509.png]]

## 网络时延
![[Pasted image 20240628203056.png]]
![[Pasted image 20240628203100.png]]



![[Pasted image 20240628204822.png]]

![[Pasted image 20240702172511.png]]![[Pasted image 20240702172515.png]]


#### 后续分组的到达时间

由于交换机能够边接收边发送，每个后续分组在第一个分组到达目的地的时间之后，每隔一个传输时间 𝑇分组T分组​ 到达目的地。具体计算如下：

##### 为什么是每隔一个 𝑇分组T分组​ 到达目的地？

1. **流水线效应**：在分组交换网络中，每个分组在到达一个节点后可以立即被转发到下一个节点。第一个分组需要经历三个传输时间（每段链路一个传输时间）才能到达目的地。而后续分组在第一个分组开始传输后，每隔一个传输时间 𝑇分组T分组​ 开始传输，因为交换机在接收一个分组时可以同时发送前一个分组。
    
2. **并行处理**：假设第一个分组在第 0 秒时开始传输，经过 0.0333 秒到达第一个交换机，同时第二个分组在主机 A 开始传输，依此类推。第一个分组在 0.1 秒到达主机 B，而第二个分组在 0.0333 秒后开始传输，经过 0.1 秒到达主机 B，第三个分组也是如此。
    
3. **持续传输**：由于每个分组的长度和传输速率都是恒定的，后续分组的到达时间是等间隔的，即每个分组每隔一个 𝑇分组T分组​ 的时间到达目的地。


# 集线器交换机带宽
![[Pasted image 20240628205113.png]]




# crc
![[Pasted image 20240702175054.png]]
![[Pasted image 20240702175127.png]]
![[Pasted image 20240625203154.png]]
![[Pasted image 20240625185714.png]]![[Pasted image 20240625185724.png]]![[Pasted image 20240625185737.png]]

![[Pasted image 20240625185814.png]]
### 生成CRC校验码

#### 步骤1：确定生成多项式 𝑃(𝑥)P(x)

生成多项式 𝑃(𝑥)=𝑥4+𝑥+1P(x)=x4+x+1，对应的二进制数为 1001110011。

#### 步骤2：数据位序列左移

数据位序列为 11010110111101011011，左移4位（生成多项式阶数为4）:

𝐷′=11010110110000D′=11010110110000

#### 步骤3：模2除法运算

进行模2除法，除数为 1001110011:

1. 11010 - 10011 = 01011
2. 01011 - 10011 = 00100
3. 10001 - 10011 = 00010
4. 10010 - 10011 = 00001
5. 10010 - 10011 = 00001
6. 10001 - 10011 = 00010
7. 10010 - 10011 = 00001
8. 10010 - 10011 = 00001
9. 10000 - 10011 = 00011
10. 10011 - 10011 = 00000

余数 𝑅=1110R=1110

#### 步骤4：生成CRC校验码

将余数 𝑅R 附加在原数据的后面，形成最终的发送数据 𝑇T:

𝑇=1101011011×24+1110=11010110111110T=1101011011×24+1110=1101011011**1110**

请输入接收到的编码数据:  11010110101110
请输入生成多项式: 10011
当前被除数:  1101
当前被除数: 11010
当前被除数: 10011
当前被除数: 00001
当前被除数: 00010
当前被除数: 00101
当前被除数: 01010
当前被除数: 10101
当前被除数: 01101
当前被除数: 11011
当前被除数: 0011
接收端计算的余数: 0011
数据在传输过程中发生了错误。


请选择模式（发送端: 1, 接收端: 2）: 2
请输入接收到的编码数据: 11010110001110
请输入生成多项式: 10011
当前被除数: 11010
当前被除数: 10011
当前被除数: 00001
当前被除数: 00010
当前被除数: 00100
当前被除数: 01000
当前被除数: 10001
当前被除数: 00101
当前被除数: 01011
当前被除数: 0101
接收端计算的余数: 0101
数据在传输过程中发生了错误。







# 数据报分片
![[Pasted image 20240625191725.png|250]]
![[Pasted image 20240625192422.png|475]]![[Pasted image 20240625192437.png]]
![[Pasted image 20240625192506.png]]![[Pasted image 20240625194233.png]] ![[Pasted image 20240625194938.png]]![[Pasted image 20240625195122.png]]在IP数据报片偏移计算中，向下调整是为了确保每个分片的数据部分长度是8字节的整数倍，从而使片偏移字段准确无误。向上调整也是一种选择，但在实际场景中，我们通常会选择向下调整，以确保每个分片的数据部分长度不超过MTU的限制。![[Pasted image 20240625195640.png]]


# 码分多址CMDA
![[Pasted image 20240625203001.png]]
![[Pasted image 20240625203254.png]]![[Pasted image 20240625203258.png]]
在CDMA（码分多址）通信中，每个站点都有一个唯一的码片序列。当一个站点发送数据时，它会使用自己的码片序列来调制信号。接收端接收到的信号是这些调制信号的叠加。为了判断哪个站点发送了数据，接收端需要将接收到的信号与每个站点的码片序列进行相关性（点积）计算。

点积结果的绝对值越大，说明接收到的信号与该站点的码片序列的相关性越强，即该站点更有可能是发送数据的站点。正值表示发送的数据是1，负值表示发送的数据是0。因此，我们需要找到绝对值最大的点积来确定哪个站点发送了数据。
# 地址聚合
![[Pasted image 20240702195440.png]]
![[Pasted image 20240626175533.png]]

# 路由器更新
![[Pasted image 20240626180002.png]]
![[Pasted image 20240626180301.png]]![[Pasted image 20240626180910.png]]![[Pasted image 20240626181241.png]]





![[Pasted image 20240630173812.png]]

| 目的网络 | 距离  | 下一跳路由器 |
| ---- | --- | ------ |
| N1   | 7   | A      |
| N2   | 5   | C      |
| N3   | 9   | C      |
| N6   | 5   | C      |
| N8   | 4   | E      |
| N9   | 4   | F      |


# 路由表下一跳

![[Pasted image 20240702202727.png]]

| 目的网络（32 位）                              | 子网掩码（32 位）                          | 下一跳     |
| --------------------------------------- | ----------------------------------- | ------- |
| **10000000.01100000.00101000.00**000000 | 11111111.11111111.11111111.10000000 | 接口 Eth0 |
| **10000000.01100000.00101000.1**0000000 | 11111111.11111111.11111111.10000000 | 接口 Eth1 |
| **10000000.01100000.00101001.0**0000000 | 11111111.11111111.11111111.10000000 | R2      |
| **11000000.00000100.01111011.00**000000 | 11111111.11111111.11111111.11000000 | R3      |
| *（默认）                                   | -                                   | R4      |

| 目的地址（十进制）     | 目的地址（32 位二进制）                       |
| ------------- | ----------------------------------- |
| 128.96.40.10  | 10000000.01100000.00101000.00001010 |
| 128.96.41.12  | 10000000.01100000.00101001.00001100 |
| 128.96.41.151 | 10000000.01100000.00101001.10010111 |
| 192.4.123.17  | 11000000.00000100.01111011.00010001 |
| 192.4.123.90  | 11000000.00000100.01111011.01011010 |

| 目的地址（十进制）     | 目的地址（32 位）                          | 下一跳     |
| ------------- | ----------------------------------- | ------- |
| 128.96.40.10  | 10000000.01100000.00101000.00001010 | 接口 Eth0 |
| 128.96.41.12  | 10000000.01100000.00101001.00001100 | R2      |
| 128.96.41.151 | 10000000.01100000.00101001.10010111 | R2      |
| 192.4.123.17  | 11000000.00000100.01111011.00010001 | R3      |
| 192.4.123.90  | 11000000.00000100.01111011.01011010 | R3      |

![[Pasted image 20240626190400.png|750]]

![[Pasted image 20240627182419.png]]
### 路由器E更新后的距离计算

#### 到Net1的距离：

- 通过A：8 + 1 = 9
- 通过B：10 + 23 = 33
- 通过C：12 + 20 = 32
- 通过D：6 + 22 = 28

最短距离是通过A：9

#### 到Net2的距离：

- 通过A：8 + 12 = 20
- 通过B：10 + 35 = 45
- 通过C：12 + 30 = 42
- 通过D：6 + 24 = 30

最短距离是通过A：20

#### 到Net3的距离：

- 通过A：8 + 24 = 32
- 通过B：10 + 18 = 28
- 通过C：12 + 6 = 18
- 通过D：6 + 8 = 14

最短距离是通过D：14

#### 到Net4的距离：

- 通过A：8 + 36 = 44
- 通过B：10 + 30 = 40
- 通过C：12 + 8 = 20
- 通过D：6 + 24 = 30

最短距离是通过C：20

### 结论

路由器E更新后到达目标网络Net1 ~ Net4的距离分别是：

- Net1：9
- Net2：20
- Net3：14
- Net4：20

所以答案为：

**D. 9, 20, 28, 20**


# 网桥转发表 
![[Pasted image 20240626193039.png|475]]


# 子网划分

![[Pasted image 20240630165311.png|475]]
![[Pasted image 20240630165813.png|475]]

### 步骤1：确定总的 IP 地址范围

C 类 IP 地址 202.60.31.0 的默认子网掩码是 255.255.255.0，即 /24，意味着有 256 个 IP 地址（0-255）。

### 步骤2：计算每个部门所需的地址数量

- 销售部门：100 名员工，需要至少 100 + 2 = 102 个地址（包括网络地址和广播地址）
- 财务部门：50 名员工，需要至少 50 + 2 = 52 个地址
- 设计部门：50 名员工，需要至少 50 + 2 = 52 个地址

### 步骤3：使用 VLSM 划分子网

我们按需求从大到小分配子网：

#### 1. 销售部门

- 需要 102 个地址，使用 /25 子网掩码（255.255.255.128），可提供 128 个地址
- 地址范围：202.60.31.0 - 202.60.31.127
- 网络地址：202.60.31.0
- 广播地址：202.60.31.127

#### 2. 财务部门

- 需要 52 个地址，使用 /26 子网掩码（255.255.255.192），可提供 64 个地址
- 地址范围：202.60.31.128 - 202.60.31.191
- 网络地址：202.60.31.128
- 广播地址：202.60.31.191

#### 3. 设计部门

- 需要 52 个地址，使用 /26 子网掩码（255.255.255.192），可提供 64 个地址
- 地址范围：202.60.31.192 - 202.60.31.255
- 网络地址：202.60.31.192
- 广播地址：202.60.31.255

### 汇总结果

- **销售部门**：202.60.31.0/25（地址范围：202.60.31.0 - 202.60.31.127）
- **财务部门**：202.60.31.128/26（地址范围：202.60.31.128 - 202.60.31.191）
- **设计部门**：202.60.31.192/26（地址范围：202.60.31.192 - 202.60.31.255）

### 销售部门

- 网络地址：202.60.31.0
    - 32位表示：11001010.00111100.00011111.00000000
- 广播地址：202.60.31.127
    - 32位表示：11001010.00111100.00011111.01111111

### 财务部门

- 网络地址：202.60.31.128
    - 32位表示：11001010.00111100.00011111.10000000
- 广播地址：202.60.31.191
    - 32位表示：11001010.00111100.00011111.10111111

### 设计部门

- 网络地址：202.60.31.192
    - 32位表示：11001010.00111100.00011111.11000000
- 广播地址：202.60.31.255
    - 32位表示：11001010.00111100.00011111.11111111


![[Pasted image 20240626201402.png]]

| 子网编号 | 网络地址           | 子网掩码                  | 广播地址           | 可用主机范围                          | 可用主机数 |
| ---- | -------------- | --------------------- | -------------- | ------------------------------- | ----- |
| 1    | 193.160.80.0   | 255.255.255.224 (/27) | 193.160.80.31  | 193.160.80.1 - 193.160.80.30    | 30    |
| 2    | 193.160.80.32  | 255.255.255.224 (/27) | 193.160.80.63  | 193.160.80.33 - 193.160.80.62   | 30    |
| 3    | 193.160.80.64  | 255.255.255.224 (/27) | 193.160.80.95  | 193.160.80.65 - 193.160.80.94   | 30    |
| 4    | 193.160.80.96  | 255.255.255.224 (/27) | 193.160.80.127 | 193.160.80.97 - 193.160.80.126  | 30    |
| 5    | 193.160.80.128 | 255.255.255.224 (/27) | 193.160.80.159 | 193.160.80.129 - 193.160.80.158 | 30    |
| 6    | 193.160.80.160 | 255.255.255.224 (/27) | 193.160.80.191 | 193.160.80.161 - 193.160.80.190 | 30    |


# 拥塞控制
![[Pasted image 20240626215829.png]]

是的，超时重传和快重传都会将**慢开始门限**（ssthresh）设置为**当前拥塞窗口（cwnd）的一半**。然而，它们在处理丢包后对拥塞窗口（cwnd）的调整有所不同：**超时重传将cwnd重置为1个MSS**，而**快重传将cwnd设置为ssthresh，并进入拥塞避免阶段。**
![[Pasted image 20240626214143.png]]
![[Pasted image 20240626214317.png]]


![[Pasted image 20240626203907.png]]![[Pasted image 20240626203913.png]]
![[Pasted image 20240626214433.png]]
![[Pasted image 20240626214443.png]]
![[Pasted image 20240626214800.png]]

### 练习

![[Pasted image 20240629182503.png]]
![[Pasted image 20240629182750.png]]


# udp数据报
给出的十六进制数据报表示为：`06 32 00 45 00 1C E2 17`。根据UDP报文格式，这些字段分别代表源端口、目的端口、长度和校验和。

#### 1. 解析各字段

- **源端口** (06 32):
    
    - 十六进制 06 32 转换为十进制为 1586。
- **目的端口** (00 45):
    
    - 十六进制 00 45 转换为十进制为 69。
- **长度** (00 1C):
    
    - 十六进制 00 1C 转换为十进制为 28。
- **校验和** (E2 17):
    
    - 这是UDP报文的校验和字段，通常用于错误检测。十六进制 E2 17。

#### 2. 数据部分长度计算

UDP报文总长度减去UDP头部长度（8字节）得到数据部分长度：

- **数据部分长度** = 28字节（总长度） - 8字节（头部长度） = 20字节

#### 3. 判断数据包方向

目的端口是69，根据已知信息，端口69通常用于TFTP（Trivial File Transfer Protocol）。TFTP服务器通常运行在端口69，而客户端会选择一个高位的临时端口。因此，这个数据包应该是从客户端发送给服务器的。

### 总结

- **源端口**: 1586
- **目的端口**: 69
- **用户数据报总长度**: 28字节
- **数据部分长度**: 20字节
- **方向**: 客户端发送给服务器
- **使用的服务程序**: TFTP

### 表格

|源端口|目的端口|长度|校验和|
|---|---|---|---|
|1586|69|28|E2 17|

### 结论

- 这个UDP用户数据报是从客户端发送给服务器的。
- 使用的服务程序是TFTP。





# csma


### CSMA/CD 计算示例

CSMA/CD（Carrier Sense Multiple Access with Collision Detection）是一种用于以太网的介质访问控制方法。以下是关于数传速率、延时、争用期和最短帧长等的计算示例。

#### 示例题目

假设有一个以太网，数据传输速率为10 Mbps，最长的电缆长度为2500米，电信号在电缆中的传播速度是2×10^8米/秒。计算以下内容：

1. 传播延时
2. 争用期（Collision Window）
3. 最短帧长
4. 数据传输效率

### 1. 传播延时计算

传播延时是指数据包从网络的一端传输到另一端所需的时间。

传播延时公式：  
传播延时=电缆长度信号传播速度传播延时=信号传播速度电缆长度​

将已知值代入公式：  
传播延时=2500米2×108米/秒=12.5×10−6秒=12.5微秒传播延时=2×108米/秒2500米​=12.5×10−6秒=12.5微秒

### 2. 争用期计算

争用期是指在以太网上检测到冲突所需的时间。通常，争用期是传播延时的2倍，因为信号需要从网络的一端传到另一端，再返回。

争用期公式：  
争用期=2×传播延时争用期=2×传播延时

将已知值代入公式：  
争用期=2×12.5微秒=25微秒争用期=2×12.5微秒=25微秒

### 3. 最短帧长计算

在CSMA/CD中，为了确保在最坏情况下能够检测到冲突，帧的最短时间长度必须至少等于争用期。在10 Mbps的以太网上，帧的最短时间长度为争用期。

最短帧长公式：  
最短帧长=争用期×数据传输速率最短帧长=争用期×数据传输速率

将已知值代入公式：  
最短帧长=25微秒×10×106比特/秒=250比特最短帧长=25微秒×10×106比特/秒=250比特

由于以太网帧的最小长度通常为64字节（512比特），我们可以看到在10 Mbps的以太网上，64字节的最小帧长已经足够满足争用期的要求。

![[Pasted image 20240702211953.png|475]]

### 总结

- **传播延时**: 12.5微秒
- **争用期**: 25微秒
- **最短帧长**: 250比特（实际以太网标准要求最小帧长为64字节，即512比特）
- **数据传输效率**: 67.2%

通过这些计算，我们可以更好地理解CSMA/CD协议在以太网中的性能特点和要求。
![[Pasted image 20240627193642.png]]![[Pasted image 20240627193902.png]]


![[Pasted image 20240628205239.png]]

# 滑动窗口
![[Pasted image 20240627172720.png|500]]
![[Pasted image 20240702214544.png|350]]
![[Pasted image 20240702214914.png]]
![[Pasted image 20240702215133.png|500]]![[Pasted image 20240702215228.png]]![[Pasted image 20240702215820.png]]
### 题目复述

主机甲通过128 kbps卫星链路，采用滑动窗口协议向主机乙发送数据。链路单向传播延迟为250 ms，帧长为1000字节。不考虑确认帧的开销，为使链路利用率不小于80%，帧序号的比特数至少是多少？

### 题目分析

我们需要计算：

1. 发送数据的总时长。
2. 为了使链路利用率不小于80%，需要发送的数据量。
3. 根据需要发送的数据量，计算滑动窗口的大小。
4. 最后，根据滑动窗口的大小，计算帧序号的比特数。

### 步骤分解

#### 1. 计算总时长

总时长包括传输时间和传播延时：

- 帧长：1000字节 = 8000比特
- 链路速率：128 kbps = 128,000 bps
- 单向传播延时：250 ms = 0.25秒
- 双向传播延时：250 ms × 2 = 500 ms = 0.5秒

传输时间（发送一个帧的时间）：  
传输时间=8000比特128,000比特/秒=0.0625秒传输时间=128,000比特/秒8000比特​=0.0625秒

总时长（一个帧的传输时间 + 双向传播延时）：  
总时长=0.0625秒+0.5秒=0.5625秒总时长=0.0625秒+0.5秒=0.5625秒

#### 2. 链路利用率计算

链路利用率不小于80%：  
链路利用率=有效传输时间总时长链路利用率=总时长有效传输时间​

为使链路利用率不小于80%，有效传输时间应为总时长的80%：  
有效传输时间=0.5625秒×0.8=0.45秒有效传输时间=0.5625秒×0.8=0.45秒

在这段时间内，发送的数据量应为：  
发送的数据量=0.45秒×128,000比特/秒=57,600比特发送的数据量=0.45秒×128,000比特/秒=57,600比特

#### 3. 计算需要的帧数

每帧1000字节 = 8000比特。  
需要的帧数=57,600比特8000比特/帧=7.2需要的帧数=8000比特/帧57,600比特​=7.2

为了保证利用率不小于80%，发送窗口大小（帧数）应至少为8帧。

#### 4. 计算帧序号的比特数

帧序号所需的比特数应能表示窗口大小。对于窗口大小为8帧，需要3位二进制位（23=823=8）。

此外，根据滑动窗口协议，发送窗口大小（N）和接收窗口大小（W）之和不应超过序号空间的大小（2^k），即：  
𝑁+𝑊≤2𝑘N+W≤2k

在本题中，接收窗口W按1计算，因为没有具体说明，所以我们可以假设最小值1：  
8+1≤2𝑘8+1≤2k

我们需要的序号空间至少为9，因此需要：  
2𝑘≥92k≥9

最小的k值为4，因为 23=823=8 不足以表示9个序号，而 24=1624=16 是最小的满足条件的值。

### 结论

帧序号的比特数至少为4位，以满足滑动窗口大小为8帧，从而保证链路利用率不小于80%。

### 总结

通过上述计算步骤，我们得出帧序号的比特数至少为4位。在滑动窗口协议中，这样可以确保在链路利用率不小于80%的情况下，传输过程的正常进行。




# 路由转发
![[Pasted image 20240627174439.png]]
![[Pasted image 20240627174443.png]]![[Pasted image 20240627181045.png|500]]
![[Pasted image 20240702221311.png|450]]



![[Pasted image 20240630173457.png|400]]
![[Pasted image 20240630173450.png|425]]

![[Pasted image 20240630174122.png|575]]
### 数据包的转发过程

当路由器 R 收到一个目的地址为 `165.13.120.78` 的数据包时，会进行以下步骤来确定下一跳：

1. **匹配路由表项**：
    
    - 目的地址 `165.13.120.78` 属于 `165.13.0.0/16` 网络。
    - 从路由表中找出最具体（最长前缀匹配）的路由项。
2. **计算子网**：
    
    - 目的地址 `165.13.120.78` 转换为二进制是 `10100101.00001101.01111000.01001110`。
    - 与每个路由项的网络地址和子网掩码进行匹配。
    - `165.13.120.78` 与 `165.13.128.0` 比较：
        - 网络地址 `165.13.128.0` (二进制：`10100101.00001101.10000000.00000000`)
        - 子网掩码 `255.255.192.0` (二进制：`11111111.11111111.11000000.00000000`)
        - `165.13.120.78` 与 `165.13.128.0/18` 网络不匹配。
    - `165.13.120.78` 与 `165.13.64.0` 比较：
        - 网络地址 `165.13.64.0` (二进制：`10100101.00001101.01000000.00000000`)
        - 子网掩码 `255.255.192.0` (二进制：`11111111.11111111.11000000.00000000`)
        - `165.13.120.78` 与 `165.13.64.0/18` 网络匹配。
3. **选择下一跳**：
    
    - 因为 `165.13.120.78` 属于 `165.13.64.0/18` 子网，路由器选择接口 m0 作为下一跳。

![[Pasted image 20240630174519.png|725]]
![[Pasted image 20240702222629.png]]
**源 MAC 地址和目标 MAC 地址会在每一跳（即每个路由器或交换机之间的转发）进行变化，而源 IP 地址和目标 IP 地址在整个传输过程中保持不变。**

![[Pasted image 20240630174803.png]]
### 问题 1: 主机 A 能否与主机 B 不通过路由器直接通信？

#### 分析

- 主机 A 的 IP 地址：202.111.222.165
- 主机 B 的 IP 地址：202.111.222.185
- 子网掩码：255.255.255.224

首先，我们需要确定主机 A 和主机 B 是否在同一个子网中。

将子网掩码转换为二进制：

Copy

```
255.255.255.224 = 11111111.11111111.11111111.11100000
```

然后，我们将主机 A 和主机 B 的 IP 地址转换为二进制：

dns

Copy

```
主机 A 的 IP 地址：202.111.222.165 = 11001010.01101111.11011110.10100101
主机 B 的 IP 地址：202.111.222.185 = 11001010.01101111.11011110.10111001
```

接下来，我们计算这两个 IP 地址的网络部分：

Copy

```
主机 A 的网络部分：11001010.01101111.11011110.10100000
主机 B 的网络部分：11001010.01101111.11011110.10100000
```

可以看到，主机 A 和主机 B 的网络部分相同，因此它们在同一个子网内。根据这一点，主机 A 可以与主机 B 不通过路由器直接通信。

**回答**：能

### 问题 2: 主机 A 不能与地址为 202.111.222.8 的 DNS 服务器通信，为什么？如何解决？

#### 分析

- DNS 服务器 IP 地址：202.111.222.8

我们需要确定主机 A 和 DNS 服务器是否在同一个子网中。

将 DNS 服务器的 IP 地址转换为二进制：

Copy

```
202.111.222.8 = 11001010.01101111.11011110.00001000
```

计算 DNS 服务器的网络部分：

Copy

```
DNS 服务器的网络部分：11001010.01101111.11011110.00000000
```

主机 A 的网络部分：

Copy

```
主机 A 的网络部分：11001010.01101111.11011110.10100000
```

可以看到，主机 A 和 DNS 服务器的网络部分不同，因此它们不在同一个子网内。主机 A 需要通过路由器才能与 DNS 服务器通信。

**为什么不能通信**：主机 A 和 DNS 服务器不在同一个子网内，主机 A 的路由配置可能有误，无法正确转发到 DNS 服务器所在的网络。

**如何解决**：

1. 确认主机 A 的默认网关配置正确（应该是 202.111.222.160）。
2. 确认路由器配置正确，可以将主机 A 的流量转发到 DNS 服务器所在的网络。
3. 确认 DNS 服务器的路由配置，确保可以正确应答主机 A 的请求。

**回答**：主机 A 和地址为 202.111.222.8 的 DNS 服务器不在同一个子网内，主机 A 的路由配置可能有误，无法正确转发到 DNS 服务器所在的网络。解决办法是确保主机 A 的默认网关配置正确，并确认路由器的配置可以正确转发流量。

![[Pasted image 20240630174841.png]]

你的理解是正确的。在 TCP 协议中，确认序号（ACK Number）的计算确实是基于接收到的数据段的有效载荷的大小。在你的例子中，由于有效载荷为 100 字节，因此确认序号会增加 100，而不是仅仅增加 1。
# cidr
![[Pasted image 20240627181859.png]]
### 1. 计算地址段的地址数量

首先，我们需要将首地址和末地址转换为二进制形式，以确定它们所占用的位数和地址范围。

**首地址：146.102.28.0**

- 146 的二进制表示是：10010010
- 102 的二进制表示是：01100110
- 28 的二进制表示是：00011100
- 0 的二进制表示是：00000000

所以，146.102.28.0 的完整二进制表示是：  
10010010.01100110.00011100.0000000010010010.01100110.00011100.00000000

**末地址：146.102.31.255**

- 146 的二进制表示是：10010010
- 102 的二进制表示是：01100110
- 31 的二进制表示是：00011111
- 255 的二进制表示是：11111111

所以，146.102.31.255 的完整二进制表示是：  
10010010.01100110.00011111.1111111110010010.01100110.00011111.11111111

**比较首地址和末地址**：

前 22 位是相同的：  
10010010.01100110.00011110010010.01100110.000111

这表示该地址段是一个 /22 的子网。

#### 2. 计算地址数量

/22 表示有 32 - 22 = 10 位用于主机地址部分。每个子网的地址数量为：  
210=1024210=1024

所以，这个地址段的地址数量是 1024 个。

#### 3. 计算网络地址和子网掩码

**网络地址**：

将主机部分全部置为0，以得到网络地址：  
10010010.01100110.00011100.0000000010010010.01100110.00011100.00000000

转换为十进制：  
146.102.28.0146.102.28.0

**子网掩码**：

/22 的子网掩码表示前 22 位为1，后10位为0：  
11111111.11111111.11111100.0000000011111111.11111111.11111100.00000000

转换为十进制：  
255.255.252.0255.255.252.0

### 结论

- **地址数量**: 1024
- **网络地址**: 146.102.28.0
- **子网掩码**: 255.255.252.0


![[Pasted image 20240627184113.png]]
![[Pasted image 20240627191044.png]]
![[Pasted image 20240627191035.png]]![[Pasted image 20240627191054.png]]

